<div class="widgets">
  <div class="row">
    <div class="col-lg-12">
      <nb-card>
        <nb-card-header>Auditoria</nb-card-header>
        <nb-card-body>
          <div class="row justify-content-end" *ngIf="downloadPath">
            <a [href]="downloadPath" class="btn btn-outline-primary btn-icon" target="_blank">
              <div><i class="ion-archive"></i></div>
            </a>
          </div>
          <div class="row">
            <div class="col">
              <label>Tipo de auditoria</label>
              <div>
                {{audit.audit_type}}
              </div>
            </div>
            <div class="col">
              <label>Fecha</label>
              <div>
                {{audit.created_at}}
              </div>
            </div>
            <div class="col">
              <label>Turno</label>
              <div>
                {{audit.shift}}
              </div>
            </div>
            <div class="col">
              <label>Tienda</label>
              <div>
                {{audit.store}}
              </div>
            </div>
            <div class="col">
              <label>Jefe de turno</label>
              <div>
                {{audit.manager}}
              </div>
            </div>
          </div>
          <div class="row" *ngIf="false">
            <div class="col-lg-12">
              <table class="table table-bordered" *ngFor="let section of sections">
                <thead>
                <tr>
                  <th colspan="5">{{section.name}}</th>
                </tr>
                <tr>
                  <th>REVISION</th>
                  <th>PUNTAJE</th>
                  <th>CALIFICACION</th>
                  <th>OBSERVACION</th>
                </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let revision of section.revisions">
                    <td>{{revision.name}}</td>
                    <td>
                      <select class="form-control" [(ngModel)]="revision.score" (ngModelChange)="onScoreChange(revision, section)">
                        <option [value]="null">Puntaje</option>
                        <option [value]="1">1</option>
                        <option [value]="2">2</option>
                        <option [value]="3">3</option>
                      </select>
                    </td>
                    <td>
                      <span *ngIf="revision.score == 1">
                        No cumple
                      </span>
                      <span *ngIf="revision.score == 2">
                        Cumple
                      </span>
                      <span *ngIf="revision.score == 3">
                        No Aplica
                      </span>
                    </td>
                    <td><textarea [(ngModel)]="revision.comment"></textarea></td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <td>
                      SUB-NOTA
                    </td>
                    <td colspan="3">
                      {{section.percentageScore | percent}}
                    </td>
                  </tr>
                </tfoot>
              </table>
              <div class="container">
                <div class="row justify-content-between align-items-center" *ngIf="score != null">
                  <div class="col-sm-3">
                    <nb-card-header >Total: {{ score | percent }}</nb-card-header>
                  </div>
                  <div class="col-sm-3">
                    <button class="btn btn-primary" (click)="onSave()">Guardar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </nb-card-body>
      </nb-card>
    </div>
  </div>
</div>
